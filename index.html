<!DOCTYPE html>
<html>
<head>
  <title>Sprite Toggle</title>
  <style>
    @keyframes wiggle {
      0% { transform: translateX(0); }
      25% { transform: translateX(-3px); }
      50% { transform: translateX(3px); }
      75% { transform: translateX(-2px); }
      100% { transform: translateX(0); }
    }
    @keyframes flash {
      0% { filter: brightness(1); box-shadow: 0 0 0 rgba(255, 255, 255, 0); }
      50% { filter: brightness(1.2); box-shadow: 0 0 12px rgba(255, 255, 255, 0.6); }
      100% { filter: brightness(1); box-shadow: 0 0 0 rgba(255, 255, 255, 0); }
    }
    @keyframes breathe {
      0% { transform: scale(1); }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); }
    }
    #sprite {
      width: 128px;
      height: 128px;
      animation: breathe 3s ease-in-out infinite;
    }
    .sprite-image {
      width: 100%;
      height: 100%;
      background: url("mage-sheet.png") 0 0 / 200% 200% no-repeat;
    }
    .mirror {
      transform: scaleX(-1);
    }
    .wiggle {
      animation: breathe 3s ease-in-out infinite, wiggle 200ms ease-in-out, flash 200ms ease-out;
    }
    .frame {
      display: inline-block;
      padding: 18px;
      background: #d0c6a4;
      border: 6px solid #5c5341;
      box-shadow: inset 0 0 0 3px #9c9276;
    }
    .portrait {
      display: inline-block;
      padding: 6px;
      background: #fff;
      box-shadow: inset 0 0 0 2px #bcb39a;
    }
    .hint {
      margin: 8px 0 0;
      font-size: 12px;
      text-align: center;
    }
    body {
      margin: 0;
      background: #000 url("background.png") center/cover no-repeat;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
  </style>
</head>
<body>

<div class="frame" style="margin:0 auto;">
  <div class="portrait">
    <div id="sprite" style="cursor:pointer;">
      <div class="sprite-image"></div>
    </div>
  </div>
  <div class="hint">Use ↑ ↓ ← → to rotate</div>
</div>

<script>
  const toggleSound = new Audio("sparkle.mp3");

  function setDirection(position, mirrored) {
    spriteImage.style.backgroundPosition = position;
    spriteImage.classList.toggle("mirror", mirrored);
    toggleSound.currentTime = 0;
    toggleSound.play();
    sprite.classList.remove("wiggle");
    void sprite.offsetWidth;
    sprite.classList.add("wiggle");
  }

  const sprite = document.getElementById("sprite");
  const spriteImage = sprite.querySelector(".sprite-image");

  document.addEventListener("keydown", function (event) {
    if (event.code === "ArrowDown") {
      event.preventDefault();
      setDirection("0 0", false);
    } else if (event.code === "ArrowRight") {
      event.preventDefault();
      setDirection("100% 0", true);
    } else if (event.code === "ArrowUp") {
      event.preventDefault();
      setDirection("0 100%", false);
    } else if (event.code === "ArrowLeft") {
      event.preventDefault();
      setDirection("100% 0", false);
    }
  });
</script>

</body>

</html>
